"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var React=require("react"),React__default=_interopDefault(React);function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(e){_defineProperty(t,e,n[e])})}return t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}var Wave=function(e){function n(e){var t;return _classCallCheck(this,n),_defineProperty(_assertThisInitialized(t=_possibleConstructorReturn(this,_getPrototypeOf(n).call(this,e))),"width",function(){return t.container.current.offsetWidth}),_defineProperty(_assertThisInitialized(t),"height",function(){return t.container.current.offsetHeight}),t.container=React__default.createRef(),t.state={path:""},t.options=_objectSpread({height:20,amplitude:20,speed:.15,points:3},e.options),t.lastUpdate=0,t.elapsed=0,t.step=0,t.update=t.update.bind(_assertThisInitialized(t)),t.resize=t.resize.bind(_assertThisInitialized(t)),t}return _inherits(n,React.Component),_createClass(n,[{key:"calculateWavePoints",value:function(){for(var e=[],t=0;t<=Math.max(this.options.points,1);t++){var n=t/this.options.points*this.width(),i=(this.step+(t+t%this.options.points))*this.options.speed*100,r=Math.sin(i/100)*this.options.amplitude,o=Math.sin(i/100)*r+this.options.height;e.push({x:n,y:o})}return e}},{key:"buildPath",value:function(e){var t="M ".concat(e[0].x," ").concat(e[0].y),n={x:(e[1].x-e[0].x)/2,y:e[1].y-e[0].y+e[0].y+(e[1].y-e[0].y)},i=function(e,t){return" C ".concat(e.x," ").concat(e.y," ").concat(e.x," ").concat(e.y," ").concat(t.x," ").concat(t.y)};t+=i(n,e[1]);for(var r=n,o=1;o<e.length-1;o++)t+=i(r={x:e[o].x-r.x+e[o].x,y:e[o].y-r.y+e[o].y},e[o+1]);return t+=" L ".concat(this.width()," ").concat(this.height()),t+=" L 0 ".concat(this.height()," Z")}},{key:"redraw",value:function(){this.setState({path:this.buildPath(this.calculateWavePoints())})}},{key:"draw",value:function(){var e=new Date;this.elapsed+=e-this.lastUpdate,this.lastUpdate=e;this.step=this.elapsed*Math.PI/1e3,this.redraw()}},{key:"update",value:function(){this.draw(),this.frameId&&this.resume()}},{key:"resume",value:function(){this.frameId=window.requestAnimationFrame(this.update),this.lastUpdate=new Date}},{key:"pause",value:function(){window.cancelAnimationFrame(this.frameId),this.frameId=0}},{key:"componentDidUpdate",value:function(e){this.props.paused!==e.paused&&(e.paused?this.resume():this.pause())}},{key:"componentDidMount",value:function(){this.frameId||this.props.paused?this.draw():this.resume(),window.addEventListener("resize",this.resize)}},{key:"componentWillUnmount",value:function(){this.pause(),window.removeEventListener("resize",this.resize)}},{key:"resize",value:function(){this.props.paused&&this.redraw()}},{key:"render",value:function(){return React__default.createElement("div",{style:_objectSpread({width:"100%",display:"inline-block"},this.props.style),className:this.props.className,ref:this.container},React__default.createElement("svg",{width:"100%",height:"100%",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},React__default.createElement("path",{d:this.state.path,fill:this.props.fill})))}}]),n}();Wave.defaultProps={paused:!1,fill:"#fff"},module.exports=Wave;
